{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>User Management</h1>
    
    <div class="actions mb-4">
        <button class="btn btn-primary" onclick="showAddUserModal()">
            <i class="fas fa-plus"></i> Add User
        </button>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('admin')">
            <i class="fas fa-user-shield"></i> Administrators
        </button>
        <button class="tab-btn" onclick="switchTab('regional')">
            <i class="fas fa-building"></i> Regional Centers
        </button>
        <button class="tab-btn" onclick="switchTab('hospital')">
            <i class="fas fa-hospital"></i> Hospital Centers
        </button>
        <button class="tab-btn" onclick="switchTab('service')">
            <i class="fas fa-hospital-user"></i> Hospital Services
        </button>
        <button class="tab-btn" onclick="switchTab('cabinet')">
            <i class="fas fa-clinic-medical"></i> Medical Offices
        </button>
        <button class="tab-btn" onclick="switchTab('doctor')">
            <i class="fas fa-user-md"></i> Doctors
        </button>
        <button class="tab-btn" onclick="switchTab('patient')">
            <i class="fas fa-user"></i> Patients
        </button>
    </div>

    <!-- Admin Tab -->
    <div id="admin" class="tab-content active">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.admin %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Regional Centers Tab -->
    <div id="regional" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.centre_regional %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Hospital Centers Tab -->
    <div id="hospital" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.centre_hospitalier %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Hospital Services Tab -->
    <div id="service" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.service_hospitalier %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Medical Offices Tab -->
    <div id="cabinet" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.cabinet_medical %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Doctors Tab -->
    <div id="doctor" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.medecin %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Patients Tab -->
    <div id="patient" class="tab-content">
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users.patient %}
                    <tr>
                        <td>{{ user.prenom }} {{ user.nom }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.organisation }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="editUser({{ user.id }})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <a href="{{ url_for('impersonate_user', user_id=user.id) }}" class="btn btn-sm btn-warning">
                                    <i class="fas fa-user-secret"></i>
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="deleteUser({{ user.id }})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

</div>

<style>
.tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    flex-wrap: wrap;
}

.tab-btn {
    padding: 0.75rem 1.25rem;
    border: 1px solid var(--border-color);
    background: var(--background-color);
    cursor: pointer;
    border-radius: 4px;
    white-space: nowrap;
    color: var(--text-color);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.tab-btn i {
    font-size: 1rem;
}

.tab-btn:hover {
    background-color: var(--hover-bg);
    border-color: var(--primary-color);
}

.tab-btn.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.btn-group {
    display: flex;
    gap: 0.5rem;
}

.btn-group .btn {
    padding: 0.5rem;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-group .btn-primary {
    background-color: var(--primary-color);
    color: white;
}

.btn-group .btn-warning {
    background-color: #ffc107;
    color: #000;
}

.btn-group .btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn-group .btn:hover {
    opacity: 0.9;
    transform: translateY(-1px);
}

.actions {
    margin-bottom: 2rem;
}

.actions .btn-primary {
    padding: 0.75rem 1.5rem;
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.actions .btn-primary:hover {
    opacity: 0.9;
    transform: translateY(-1px);
}
</style>

<script>
function switchTab(tabId) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Deactivate all tab buttons
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Show selected tab content
    document.getElementById(tabId).classList.add('active');
    
    // Activate selected tab button
    document.querySelector(`[onclick="switchTab('${tabId}')"]`).classList.add('active');
}

function showAddUserModal() {
    // Implement modal show logic
}

function editUser(userId) {
    // Implement edit logic
}

function deleteUser(userId) {
    if (confirm('Are you sure you want to delete this user?')) {
        // Implement delete logic
    }
}

// Initialize first tab
document.addEventListener('DOMContentLoaded', function() {
    switchTab('admin');
});
</script>
{% endblock %} 